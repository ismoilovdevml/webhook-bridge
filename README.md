# Webhook Bridge

> Universal Git webhook receiver â†’ Multi-channel notifications

**Supported Platforms:** GitLab, GitHub, Bitbucket
**Notification Channels:** Telegram, Slack, Discord, Mattermost, Email

## âœ¨ Features

- ğŸ”— Universal webhook receiver for all major Git platforms
- ğŸ“¢ Multi-channel notifications (Telegram, Slack, Discord, Mattermost, Email)
- ğŸ¨ Customizable message templates (Jinja2)
- ğŸ”’ End-to-end encryption for sensitive data
- ğŸ§ª Built-in webhook testing tool
- ğŸ“Š Event history and analytics
- ğŸ¯ Advanced event filtering
- ğŸ”„ Automatic retry with exponential backoff
- âš¡ Rate limiting with proxy support
- ğŸ³ Docker-ready with auto-initialization

## ğŸš€ Quick Start (3 commands!)

```bash
# 1. Clone and enter directory
git clone https://github.com/yourusername/webhook-bridge.git
cd webhook-bridge

# 2. Run setup script (auto-generates secure keys)
bash scripts/setup.sh

# 3. Start services (auto-creates database)
docker-compose up -d

# âœ… Done! Access: http://localhost:3000
# Login credentials shown in setup output
```

**That's it!** The database will be automatically created and initialized on first run.

## ğŸ“‹ Requirements

- Docker & Docker Compose
- Python 3.7+ (for setup script)

## ğŸ”§ What Happens Automatically

When you run `docker-compose up -d`:

1. âœ… Backend container starts
2. âœ… Database automatically created (if doesn't exist)
3. âœ… Database schema initialized
4. âœ… Admin user created
5. âœ… Services ready to use

No manual migration needed!

## Setup

### 1. Login
- URL: http://localhost:3000/login
- Username: `admin`
- Password: Check setup script output or `cat .env | grep ADMIN_PASSWORD`

### 2. Add Provider
Dashboard â†’ Channels â†’ Click provider icon â†’ Enter credentials â†’ Test â†’ Save

**Telegram:** Bot token + Chat ID
**Slack/Discord/Mattermost:** Webhook URL
**Email:** SMTP settings

### 3. Configure Git Webhook

**GitLab:**
```
Settings â†’ Webhooks â†’ Add webhook
URL: https://your-domain.com/api/webhook/git
Triggers: Push, Merge Request, Pipeline, etc.
```

**GitHub:**
```
Settings â†’ Webhooks â†’ Add webhook
Payload URL: https://your-domain.com/api/webhook/git
Content type: application/json
Events: Push, Pull requests, Issues, etc.
```

**Bitbucket:**
```
Repository Settings â†’ Webhooks â†’ Add webhook
URL: https://your-domain.com/api/webhook/git
Triggers: Push, Pull request, etc.
```

### 4. Test
Push a commit â†’ Check History tab for events

## Production Deployment

### Manual Deployment

```bash
# 1. Server setup (Ubuntu)
curl -fsSL https://get.docker.com | sh

# 2. Clone and setup
git clone <repo> /opt/webhook-bridge
cd /opt/webhook-bridge
bash scripts/setup.sh production

# 3. Start services
docker-compose up -d

# 4. Check logs
docker-compose logs -f
```

### Nginx Reverse Proxy

```nginx
server {
    listen 80;
    server_name your-domain.com;

    # Frontend
    location / {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Backend API
    location /api/ {
        proxy_pass http://localhost:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

Secure with SSL:
```bash
certbot --nginx -d your-domain.com
```

## Development

```bash
# Backend
cd backend
pip install -r requirements.txt
uvicorn app.main:app --reload

# Frontend
cd frontend
npm install
npm run dev
```

## ğŸ”§ Useful Commands

```bash
# View logs
docker-compose logs -f backend

# Restart services
docker-compose restart

# Rebuild after code changes
docker-compose build && docker-compose up -d

# Run backend lint
docker-compose exec backend flake8 app/

# Run frontend lint
docker-compose exec frontend npm run lint

# Access backend shell
docker-compose exec backend bash

# View admin password
cat .env | grep ADMIN_PASSWORD

# Test webhook (sample payloads)
curl http://localhost:8000/api/webhook-test/samples
```

## ğŸ§ª Webhook Testing

Built-in testing tool at `/api/webhook-test/*`:

```bash
# Get sample payloads
curl http://localhost:8000/api/webhook-test/samples

# Test webhook parsing
curl -X POST http://localhost:8000/api/webhook-test/parse \
  -H "Content-Type: application/json" \
  -d '{"platform": "gitlab", "event_type": "push"}'

# Test with real provider (replace {id} with provider ID)
curl -X POST http://localhost:8000/api/webhook-test/send \
  -H "Content-Type: application/json" \
  -d '{"platform": "gitlab", "event_type": "push", "provider_id": 1}'
```

## ğŸ“ Environment Variables

**Auto-generated by setup script:**
- `SECRET_KEY` - JWT token signing (32+ chars)
- `ENCRYPTION_KEY` - Provider data encryption (Fernet key)
- `WEBHOOK_SECRET` - Git webhook signature validation
- `ADMIN_PASSWORD` - Admin login (16 chars)

**Optional configuration:**
- `ADMIN_USERNAME` - Default: admin
- `ADMIN_EMAIL` - Default: admin@localhost
- `ENVIRONMENT` - production/development
- `RATE_LIMIT_ENABLED` - Default: true
- `RATE_LIMIT_PER_MINUTE` - Default: 100

**Frontend:**
- `VITE_API_URL` - API base path (default: /api)
- `VITE_BACKEND_URL` - Backend URL for dev (default: http://localhost:8000)

See `.env.example` for all available options.

## Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Git       â”‚â”€â”€â”€â”€â”€â–¶â”‚  Webhook     â”‚â”€â”€â”€â”€â”€â–¶â”‚  Notification   â”‚
â”‚   Platform  â”‚      â”‚  Bridge API  â”‚      â”‚  Providers      â”‚
â”‚             â”‚      â”‚              â”‚      â”‚                 â”‚
â”‚ GitLab      â”‚      â”‚ â€¢ Parse      â”‚      â”‚ â€¢ Telegram      â”‚
â”‚ GitHub      â”‚      â”‚ â€¢ Filter     â”‚      â”‚ â€¢ Slack         â”‚
â”‚ Bitbucket   â”‚      â”‚ â€¢ Transform  â”‚      â”‚ â€¢ Discord       â”‚
â”‚             â”‚      â”‚ â€¢ Route      â”‚      â”‚ â€¢ Mattermost    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ â€¢ Email         â”‚
                              â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚   Dashboard    â”‚
                      â”‚   (Vue 3)      â”‚
                      â”‚                â”‚
                      â”‚ â€¢ History      â”‚
                      â”‚ â€¢ Configure    â”‚
                      â”‚ â€¢ Monitor      â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## License

MIT
